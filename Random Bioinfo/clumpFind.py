#Finds patterns forming clumps in a string
#Input string genome, int k(length of clump),L(size of genome to check), t(number of times found)
#Return all distinct k-mers forming (L,t) clumps in genome

#Finds index of where a pattern found in a genome
def patternOccurence(pattern, genome):
	stIndex = []
	patLength = len(pattern)

	for i in range(len(genome) - len(pattern)):
		kmer = pattern[0:patLength]
		if genome[i: i + patLength] == kmer:
			stIndex.append(i)


	return len(stIndex)

'''
Could probably be faster if modify patternOccurence to cycle through genome and mark locations where pattern is in a dictionary
Way too slow against E.coli
'''

#Finds t kmer clumps in a genome l long
def clumpFind(genome, kmer,l,t):
	pat = set()
	answer = ""

	for i in range(len(genome) - l):
		trunctG = genome[i: i + l]
		pattern = trunctG[0: kmer]
		if kmer not in pat:
			if patternOccurence(pattern,trunctG) >= t:
				pat.add(pattern)

	word = ""
	for i in range(len(pat)):
		word += pat.pop() + " "

	return word



'''
text = "CGGACTCGACAGATGTGAAGAACGACAATGTGAAGACTCGACACGACAGAGTGAAGAGAAGAGGAAACATTGTAA"

k = 5
l = 50
t = 4
# CGACA GAAGA
print(clumpFind(text,k,l,t))
'''
'''
text = "AGCCATTGCGGTCCCACAAGAGTAAATTCTCATAGAGACAGTGTGTTCGTACTGGTAGACCTGTTCGTGTAAGCAGCTCCTGCTCGCTTACGATGTGGCCTCACGAGCGTGCCGATTCCAGGATCAGTGAAAGAATCGCAATATAATAGAAGGTGTCCGAGTCTGCCCATAACCATCTGCGGCCTTCCCCGACCTGTTTCATCGGGTCTTTGGGCCCCGGACCACATACTGTAATGTACTCTTGTGGATTTTACGCAAAGAGAGAGCCTTCTTCGGTTAAAGCATGGGTGTCCTACGTTCATCCGCGTGGAGTAGTACCTAGAGATCCTTGGAGCACTACTATAACACCGAGTAGTTCGCTTCCCCGGGCTGGCGCTCGCAATGATTTACATTGGGCAAATCTTTCGGGAGCTACGCCGGGCCGTGCTTCCCTCTGGCCGAGGATTGTGGCTACCAGTGAGCTCCAGGGGAAAAATTGTAGCTGAGTAAGCTAGACAACACTGGACGGTACCTCCACGACATGCACGGGTAACTATCGGGCGAGTTTCTTTTGGACATTAATGCCCGTACACTATGGACCCACAAGACATTTACCGGTCAGTGGCAGATGGATGTGTGGCCGTACAAAGCTCTCAGCGCTCATGTTAGTTGCACAGGGGTCGCGCTTTCCAACGCCTAGTTGTCGGATGGTGAGATGACCCTTTTAAATGGAGCTCGCCATGCTTCAGGGCACATAATTCTTCGAGGGCGGAACGAATCGTCAAAGGTCCTCTAGTCCAGCCGGTGGACAGTCAAGGCCCGCGGATCAGGTCACTTCATGGCGGACGAACGGAAGAGCGACTCGAACGTTATTGCACGTCGGATCATGTCCCAACCACCACAAGTTCGTCCCCTGATACGCGTTACCACAGACATTGAGCGTCAAGATGCGTGACGCAAGGGAATTTCCAGCAGGCGGTGCCGCGAGACGTGTCCATTTCGCCATCCCAGGAGTCTGATCCGCTCCAGGATTTAGGATTTCTTCTCGCTAATGCCAGGATTTGGATTTATTCTCTCACCATCTTGCCCGTGCCCCAGGATTTCGGTCTGCCCGGTCCCTGCCCGGTCTTCTTGCCCGCCAGGATTTCTTGGCCAGGATTTGATTTCAGCCCCAGGATTTTGTTAAGCTAAGTCTTGCCCGGTCCTCTATCCAACCAGGATTTGACCCACCAGGATTTCTTGTGCCCAGGATTTGGAAATGCCCGGTCCGCTGCCCGGTCCCCCCAGGATTTGGTGGGGAATCGCTTAACTATGCCCGGTCCACCAGGATTTCCAATCCAGGATTTCCCAGGATTTTTTGCCCGGTCATCCAGGATTTGGCTAACCTTCTTGGCCAGGATTTGCTGGTTATTGCCCCCAGGATTTCCAGCCAGGATTTCCAGGATTTCGCCAGGATTTTTTGCCCCCAGGATTTTGTTGGACCAGGATTTTCATCATTGTGCCCCCAGGACCAGGATTTTGCCCGTGCCCGGCCAGGATTTATGCCCGGTCTCCATAGTTATCAGCACCAGGATTTTATGTGTATTCTGCCCGGCCCCAGGATTTATGCCCTGCCCGGTCACTGCCCGGTCCGGTCCATCGACATACGACATCGACTCGACATACCGGACCACCAGCTCCAATCGACATACCCAAGGTATTAAGATGTTCGTATGATTCGACATACTACACTCGACATACGGCTCGACATACGCACGGTGTCAATATCCCGGCTAAAGTCGACATACGTATCTTTCTCTTGAGTTCTCTCGACATACTCGACATTCGACATACCTCTTGAGACTACGCCTTTATACCATCTCGACATACGTATAACCGGATTCGACATACCCTCTTGATGTTCGACATACAGGTATATCGAATTGAATCTTATTCCGCCAATTTTCTCTTGAGCCTCGTCGACATACCATCGACATACGGCCCAAGGTATGTATAAGGGAACTTCTCTTGAGGTCCAATCGACATACAACATAGTTCGACATACACCATTCTCTTGACTTCGACATACCTTGCCAATTCTCTTGAGTATAGTCGACATACCAAGGTATCATTCTTCGACATACCATACTGTTCTCTTGAAAACCCAAGGTATCGTCGAGTCGACATACACGAAGAGACAGGGACTCGACATTCGACATCGACATACACAATTCTCTTGATCGACATACCTTTCTCTTGAGTGTTATTGGGGTTCTCTTGAAAGGTATTTCTCTTTCTCTTGATACTTCTCTTTCTCTTGAATCTTGATCCGTGTTCTCTTGATCTTCTCATTTCTTCTCTTGATTCTCTTGATGACTATGTCTCGTGTTCGTTTCTCTTGATGAGTTCCCGTGTCTTGAGGTCGTCTCGTGTTCTCAGTCAGCGTCTCGTGGTCTCGTGTATTATTACCATTCCACCTTGGGATTGTCTCGTGTATGTCTCGTCTCGTGTTGTTAAAGGTGTCTCGTGTTATCTTTGGTGAGACACGGGCTATGTCTCGTGTCTCGTGTCAGGATGATGTTCTTGGTCTCGTGTAGGTGGCGACCTTTATTTCATCGTCGTCTCGTGTGTACACGTGATCTTTTTATTAGTCCCTTCTTTGAACGTTCAGAAGGAGCCCCATGGTCTCGTGTGAATCGAATGCTCAGACACGGGCGGTCTCGTGGTCTCGTGTCTCGTGTTCGTGTATGGGGACTAGTCCCTGAAGCCATGGGTCTCGTGTACCCGTACCAGGTCTCGTGTGTCGGGACCGCCAGTCTCGTTGCGCCGTCTCGTGTATGTCGGGACCGGGTGCAGTGTCGGGGTCGGGACCATCCAGTCTCGCCCCCCCCTAGAACTAGTCAGGGACTACCAGTCGTCGGGACCCTTCTCATTGGGATTATTACTCTGGAAGTTACGCGATTCGGTCGGGACCCCGGGTCGTCGGGACCGGACCCAGTCTCGTCTCGCCCAGTCTCGTCGGGACCGGACCCTCGTCGGGACGTCGGGACCCCAGTCTCGGTCGGGACCTCCGTCGGGACCTCTCGGGGCATGCCCAGTGTCGGGACCTGGTCGGGACCCCAGGTCGGGACCGTCTCGGTGACTTTCCAGCCAGTCTCGCTCGTCGGGACCCCCAGTCTCGAAACCAGTCTCGAATCGCGTTGACCAGCCAGTCTCGGCGTGTTGGTTCAAAATCTAGCCAGTCTGTCGGGACCTCTCGATCATATCTCCAGTGTCGGGACCCCCGCAAATTGCGCCAGTCTCGTCGGTCGGGACCTCCGTGGTCGGGACCCTCGTGCCGTCGGGAGTCGGGACCGGACCGACCTCTCCAGTCTCGGACATGCGTCACTATATATCATTCCGGCAACTTATTACCATTCGCGTCCGTCCACGTCCAGGCTCTATCGTCCAGGCCGTCCAGGCGTGTGTGGATCAACCAATCTCGTCCAGCGTCCAGGCGTTGTACTGCTAGCTTTATAATCTGCGTCCAGGCCTCTCATCACGGCCGCGTCCAGGCCCCGTCCAGGCTGGCGTCCAGGCTCAGGTACGTCCAGGCCGGGCGTAGATCACGTCCAGGCTGTGTGTACCCGCTACTGTGGCAAAAACGTCCAGGCACACACGTCCAGGCCCTTCTCGTCCAGGCTCATCTCGCGGGACCTAAGTCAAAGTCGTCCGTCCAGGCAGACGTCCAGGCCGTGTGACACACTGCCTCGTCCAGGCTTCGTCCAGGCGACCGTACAAGCCGTCCAGCGTCCAGGCCAGGCCGTCCAGGCGGAGCTTTATCAGCTGAGTCGACGTCCAGGCAGATCGTCCGTCCACGTCCAGGCCCTTACGATCGTCCAGGCTCGTCCAGGCGGCGTCCAGGCATGGCCGCCTCGTCCAGGCTGCCTTTTCAAGAAAAGCGCGGCTGATGGAGGCAGACCCTGTCGGTTCGTCCAGGCATCGGCCGATGCCCGCCTCGAGCTGCTGGTGCTATCCCGCATCCGACGAATCATTCACCTCATCGAACTCAAAAACCGATAAGTAGAATCAGCATATTGGAACTCACAATATCTGTTTCACGCTACTCCTTGGGGCTAAATACATCTGGCACCCTAATGGTCCCGACTAGGCCTAAGAAAGGCTTACATGTTTAGGTATACCGAAAATGACATTGTTCAGGTGTTGTCCACTACAGGAGACTGATCGACGAACTTTATCGAAAGTAGCGTTCTGTCAATGACTTATTATAAACTCCAGGGTGTGACAACTGAGCGTTGAAGCGCCCGCCGCAGTCCCAAGTGCGACAACGTGACGGCATAACCAAAACATACACGACAGTCCGGCAGAGGCTAGGTGTCCATATCGACTTCTACATCAATCTTGGATCTGACATCAGGTTTACGTCATGGGACAAGTCATGATCACTACCATAACCCACGTAAAACTATATGCTCATTTATATATGTGGTCGAAGTTCCTGGGCGGTCAGGAACATCAGTAGTGCCTGACAGACCAACTTACACGCTTAGGGTGTTAAGGTCGGGCTGACAAAGTCGACCCTCTAGTTAGTATTGGGATACCTAGTCAGGCTCCAATCCGTACTGTATATACTCATTACGGGTAGACTGGCCCAGTGTTGCAGATCGTGGGAGCGTACCAGAGGGCGTCCACCTTCTATACCAGACTCATGAAGCAACAAGTTAGAGATGCCCGGCCGCAGACCTGTTCCTGCAATGTTATCGGAGCAGAAATTCATGAGTCGCGGTAGTTATTGTGTTCTATACTAAAAGCAAGAAATCTTGCCCGCCAACAGTAATATCACAAAACGTCGATTCCGTTACTTATAATTGCGTATAGAAAATTGCTATGCCCTCCCACAACACCGTGAGGCCAATGAATAAGGTTCGACTCTTGATACGCTCATTTCGATGGAATTGGAATAACGTTACCCGGTCTAGCTCTAGGAAGAATTCCTTCTGGGCCGCTAGTATCTCATTGCCATGTGAGAGATATGAGTGTGGTGGTGTCCTTGTCTCATCCAATCGATGACCATTAACTTGTCAAGGAGGTAGCATTATTAAAACTATTTCTATATAAGTTCCGCAGTCTGTTGCCTGCTCGTTACACCAGGTTAACCTCAAGCCGGGAAAGATACGCCACATCTATATAAGTGCTGTAGTGGTAGCTTGCCGCCCGATGATTTAGGTATGCGAACGAAAAAGCCCGTCAAAGCCCGTAGGGTCGTCTCTACTCATTGGCCCATTTAAAGCCCAAAGCCCGTCCGTTTCTAAAAGTTTTAAGGCAAAGCCCGTAAGCCCGTCCCGTTCAAAGCCCGTAAAAGCCCGTACAAAAGCAAAGCCCGTGGTAATATCTTTTGACCTAGGCGGAGGCATCCGGCTTGTAAAGCCCTTCTCAGCAAGACAAAAGCCCGTTTTGTCCCGTCTGCATCGCTTCGCGTAGCTCGGGATCGAAAGCCCGTCAAAGCCCGTAATCGCCCGTAGTAGCATTTTGATTGAGATCAAAGCCCGTCCCAAAGCAAAGCCCGTAAGCCCGTGTGTCAAAGCCCGTAAAGCCCGTTCCCTGCAAAGCCCGTTCTACTGACGCAAAGCCCGTCGCTCTAGAAAGCCCGTAAAGCCCGTAAAGCCCGTCCCGTTGAAAGCCCAAAGCCCGTCAAGGCATAAGCGAAGAAAGCCCGTGAGACGTCCTGCTAAAGTGCGGATGGGGGGGCGGAGGTGCGAAAGCCCGTACACATGCCGATTAAAGCCCGTCGAAGTACGCTTGGATGTAGCAACTAAAAAGCCCGTCTGTACAAGGCCCAGACTGTAGCAGCAAGACCAACTCGCCATAGAACGATAGCAAAAGAGAAGAACACACCCATGAAGGGTCTTAACGGTGTATGCCGCACCACTGGTGGTTATGACCGCTGCTCGAGGAGCCCTAAGGGTTGTCCGCTCTGCCATCACCGTAAGCACCTTACGTGCAGCCACGACCACTCTGTAAATCCCCGACATTGCACCCGCTGCCGATAATTCCCCTGTCGACTACGCAAGCGCGGTTGCACAATCCGCTTTACTGAAGGGGTGCCGGCTAGGAGGTCCCTATTCAGCGACACGCCCTTTGTTTGCTAACAGGCGAAGAGGCTCGTTAGGATTCGTTATGTTAAAATGTGGTATTTGTTCCAACCACCTGAACTCTTTAAGACATTACTCAAAAGTCGTCAAAGAAAATTAAGTTCCACCGGCACACTGTGTACATTGCAATATCCAGAGCCGCCCAGATGGCGCCGCCCGCCCAGATGTTCACGCCCAAAAGGCCGAGCCAAAGGCCGACAGATTCGTTCTAAAAGGCCGATGACCGCTGGCGTAGTTAGAAAAAGGCCGAAGATCCAGATAAGATGAACAGGTGCCTTCCCCCGCCCAGATAAAGGCCGAGAAAGGCCGAAATGTAAAAGGCCGAGATCCCAGATAAAGGCCGAATTGTGAAAGGCCGAGAGCGCCCAGATCGAACTCGCCCAAAGGCCGAAAAGGCCGAAGCCGCCCAGCGCCCAAAGAAAAGGCCGAAAGGCCGAGTAAAGGCCGACAGATACATCGGGCAAAGGCCGAACGAGCAAAAAGGCAAAGGCCGACCTCTCCTCCGATTCCGCCCAAAGGCCGAAGGCCGACCGGCCACAAATCTCATCGCTGGGACATTAACTAGCGCCCAGATGAAAGGCCGAGCCAAAGGCCGACAAAAAGGCCGAATTTAAAGGCCGACCAGCGCCCAGATGATCCAGATTTTGACAAAGGAAAGGCCAAAAAAGGCCGAAGATAAAGGCCGAGCCGAAGATAAAGGCCAAAGGCCGAGCCTTTTGCTCCAAACAAAGGCCGACTACGAAAGGCCGAATTGATCGGACGCAACGGGTCTAGCGTTTCAGTCTTACCGCTGATCTCGCGGAAAAATTCTTGAATTCTGCATCCAGCTAACATCACGGTAGGTACGTCCCTGGAAGTCCTCCTCCCTCTACTCTTGGTGACGAGCTCCTGTCGGGTGGCTGGGCGTGTGTGCCGAGGGTTCTACAGATAAGTTGCAGGTGGACGTCAAATACCGTCATGTCAAGAACACGATGAATACACATGTGGTCATGACCAGTTGAATGAATCACAATCGCTTAAAAGTTAAAGAACCAGAACTGTGCAACCAAACCAGAACACCTAGCTCGGTCCATAAGTGTAACCAGAAACCAGAACAACGTTCCATTTGCGGAGCGATTAACCAGAACAGAACACGGCCGAAACCAGAAACCAGAACTTCTGTTTTCTCCCCAAACCAGAACCACTGGCGCCACACGCAGTAGACATCCCATATGGTTGACATAAAGTCCTGCATCAACCAGACCCGTGCCGTGAGATCGTGAGACCGTGAGATCCAGAGTAACTTTTGCTTTCAAACCAGAACAGAACCGTGAGATAGATACCAGAACTATGCTAAACGGGCCGTGAGATTACCCGTGAGACCGTGAGATATGTATAACCAGAACCACCGTCAACCAGAACCAGAACACTAGGGAAAACCAGAACCCGTGAGATCCCAGAACAACCAGAACAATGAGCGTTTAACCGTGAGATAGATGTCCCGTGAGATGAACCTGAGCGTTTCCATGAGCGTTTGATGAACTAATTCCGTGATGAGCGTTTAGATGAGCGTTTTTTAGACAACCAGAACGTCCGTGAGATCCGTGAGCGTTTGCGTTTTGACCCCGTGAGCGTTTGTTTGAGCGTGAGCGTTGAGCGTTTTGTGAGCGTTTGAGATTGAGCGTTTACTGAGCGTTTTGAGATTTGAGCGTTTAGTCATACGTGAGCGTTTTTGAGCGTTTGAGCGTGAGCGTTTAGCGTTTGAGCGTTTCACCGTACGCTATCTTAACACACGCTATCTACGCTGAGCGTTTTTTTGAGCGTTTCACGCTATCTCGCTATCTCGCCACTTGGCTTGAGCGTTTGGGGAATGAGCGTTTTCTCTACCCAGTGTGAGCGTTTCGCTATCTCTATCTATGCCGTAAGACGCTATCACGCTATCTTCATGAGCGTTTCCTGCCATTGCGCTATGAGCATCAGTATGAGCGTTTTCGCTATCTCACGCTATCTGCATGAGCGTTGAGCGTTTTTTGGTGGATCGGATAACAACGCTATCTACATCGGGCTAACCCCCACGATATCGCAAATGTGCAGCACTTGACGCTATCTCGCTACGCTATCTGCTATCACACGCTATCTCTATCTAACGCTATCTCAGGTACGCTATCTGCTATCTGCTTCGGAGGCTACAGCTAGACGCTATCTTCCAGTTGGACTGGATAAAACCACGCTATCTATAATACTACGCTATCTGACGCTATCTGCCTGGGCAATCCAAGGGCGATGCAATATTTGACAATATCATCAAGCGTTGATGCGAGCAATCGAGAAAATTCCCTTCAGTCTTACGTAGTCAAGATATCGGACCTTTCTCCCCTACCATTTGCCATACCTTCTGCCCCGATGTACTATGAGCGCAAGGCGTAGCACTGGCCTTCAAATCATCGTTTTGTGTAACTCTAAACGTTTGAAATCCTTGGCCTACTGCGCATCGGTACAGGTGGTGCAGGAGTATCAGGCGACGACCGGAACTTGCGTTGAGCAGTGTGGAAGTGAACCAAGTCAGGCGCCTAGGACTGCACACGTGTCAGCGCCGAATCAAGAATTTCCGCGTTGCAAGAGCCCTGTCGACCACATATGTTAAGAGGCCATGGGAGTAATACGCAATAAATTTGGTGCAAATGTAGATACCAAGGTTTTAATACGACGCTTTGAAGGAGTATACTTTGAAGACGGACGGATAAGTGATCACGTGTGGCGGCAATTTCACCACGATTTGAACCACGTAGGTCGAACCCGAATATAAGCTATTATGACCTGGGGAGTGTCATCTCATGGAAGTGGCGGCCCGTCTTTTAATCGGAGTATCGTAAGGCATGATCAGCGGGGATTAGTGGTGTGTAGGACGATCGATCCCGCTGCTACCTTTGGACACCTTACCGGGACACATGTTAATGAACATATGTTCTTGTTTGGTCCGTTAGAGGACAGCGGCCTATAGAAATAGGAACACGCTAGATCGATAAAGCGAGGTCGACACAGTCCGGCCGAGCTGCTGTATGTGACACAGAACGAGTCAGCCAGAAGCTCTTCCGACACACTTGTGACGATACCGAACATGATATCCCAGTTGGAGACCAGCTAGTTCTGTTCTACGCGGCCAGGACTTCGCAGTGGAAGATTGGGACACTATCGTCGGGTCAACGTTTGAGACCACCTGTGGAGAACTTGGGTGCCAGGAGGGCGTTTTTTGCATATATAAGGTGGACCGGTGTAGCAGGCGTACTAGTTCCAATCACCAGGTTTTGCGCGTATTAAGCTTTGCACGTCAACCGCACATTTGGCCACCGGGTTCCTATTCAGACAAGCAAGTACGATGCTCCCTTCATAGATGTGCGCCCCCCGATTTACGCTGGTCACTCAGGCTTGCGGACAATTGCGGCGACAAACTTCAAACATGGGATGTGTCGATTTGGCGGGAGGTCTGCACCCTTGGGAGGTCCCCACGGCGCAGCATCAGTACTCATGGTTGAATTCACTTGCGCTGACCGAGCAGGGTTATATAGTTCACGCACACTATTCGGAGGGCTCGCCTTTTGTCTCCACTTCCTAGGCCTATACTCCCCATAA"
k = 9
l = 589
t = 19
#TCGACATAC GTCGGGACC AAAGCCCGT CGTCCAGGC AAAGGCCGA TGAGCGTTT CCAGGATTT 
print(clumpFind(text,k,l,t))
'''
